<sqlMap>
    <sql id="dropTablePolicy">
		DROP TABLE IF EXISTS IDMF_POLICY
    </sql>

    <sql id="createTablePolicy">		
        CREATE TABLE IF NOT EXISTS IDMF_POLICY (
            POLICY_ID       TEXT(50) PRIMARY KEY,
            POLICY_CODE     TEXT(50) NOT NULL,
            EFFECT          TEXT(6) NOT NULL
        );
    </sql>

    <!-- RULE TABLE -->
    <sql id="dropTableRule">
		DROP TABLE IF EXISTS IDMF_RULE
    </sql>

    <sql id="createTableRule">		
        CREATE TABLE IF NOT EXISTS IDMF_RULE (
            RULE_ID         TEXT(50) PRIMARY KEY,
            RULE_CODE       TEXT(50) NOT NULL,
            POLICY_ID       TEXT(50) NOT NULL
        );
    </sql>

    <!-- SUBJECT TABLE -->
    <sql id="dropTableSubject">
		DROP TABLE IF EXISTS IDMF_SUBJECT
    </sql>

    <sql id="createTableSubject">		
        CREATE TABLE IF NOT EXISTS IDMF_SUBJECT (
            SUBJECT_ID                  TEXT(50) PRIMARY KEY,
            SUBJECT_CODE                TEXT(50) NOT NULL,
            RULE_ID                     TEXT(50) NOT NULL,
            VALUE_TYPE                  TEXT(20) NOT NULL,
            EVAL_TYPE                   TEXT(20) NOT NULL,
            VALUE                       TEXT(100) NOT NULL
        );
    </sql>

    <!-- RESOURCE TABLE -->
    <sql id="dropTableResource">
		DROP TABLE IF EXISTS IDMF_RESOURCE
    </sql>

    <sql id="createTableResource">		
        CREATE TABLE IF NOT EXISTS IDMF_RESOURCE (
            RESOURCE_ID                 TEXT(50) PRIMARY KEY,
            RESOURCE_CODE               TEXT(50) NOT NULL,
            RULE_ID                     TEXT(50) NOT NULL,
            VALUE_TYPE                  TEXT(20) NOT NULL,
            EVAL_TYPE                   TEXT(20) NOT NULL,
            VALUE                       TEXT(500) NOT NULL
        );
    </sql>

    <!-- ACTION TABLE -->
    <sql id="dropTableAction">
		DROP TABLE IF EXISTS IDMF_ACTION
    </sql>

    <sql id="createTableAction">		
        CREATE TABLE IF NOT EXISTS IDMF_ACTION (
            ACTION_ID                   TEXT(50) PRIMARY KEY,
            ACTION_CODE                 TEXT(50) NOT NULL,
            RULE_ID                     TEXT(50) NOT NULL,
            VALUE_TYPE                  TEXT(20) NOT NULL,
            EVAL_TYPE                   TEXT(20) NOT NULL,
            VALUE                       TEXT(100) NOT NULL
        );
    </sql>

    <!-- CONDITION TABLE -->
    <sql id="dropTableCondition">
		DROP TABLE IF EXISTS IDMF_CONDITION
    </sql>

    <sql id="createTableCondition">		
        CREATE TABLE IF NOT EXISTS IDMF_CONDITION (
            CONDITION_ID                TEXT(50) PRIMARY KEY,
            CONDITION_CODE              TEXT(50) NOT NULL,
            RULE_ID                     TEXT(50) NOT NULL,
            VALUE_TYPE                  TEXT(20) NOT NULL,
            EVAL_TYPE                   TEXT(20) NOT NULL,
            VALUE                       TEXT(50) NOT NULL
        );
    </sql>

    <!-- REVISION TABLE -->
    <sql id="dropTableRevision">
		DROP TABLE IF EXISTS IDMF_REVISION
    </sql>

    <sql id="createTableRevision">		
        CREATE TABLE IF NOT EXISTS IDMF_REVISION (
            REVISION TEXT PRIMARY KEY
        );
    </sql>

    <insert id="insertPolicy" sqlfile="insertData/policy.json">
        INSERT INTO IDMF_POLICY(POLICY_ID, POLICY_CODE, EFFECT) VALUES(?,?,?);
    </insert>

    <insert id="insertRule" sqlfile="insertData/rule.json">
        INSERT INTO IDMF_RULE(RULE_ID, RULE_CODE, POLICY_ID) VALUES(?,?,?);
    </insert>

    <insert id="insertSubject" sqlfile="insertData/subject.json">
        INSERT INTO IDMF_SUBJECT(SUBJECT_ID, SUBJECT_CODE, RULE_ID, VALUE_TYPE, EVAL_TYPE, VALUE) VALUES(?,?,?,?,?,?);
    </insert>

    <insert id="insertResource" sqlfile="insertData/resource.json">
        INSERT INTO IDMF_RESOURCE(RESOURCE_ID, RESOURCE_CODE, RULE_ID, VALUE_TYPE, EVAL_TYPE, VALUE) VALUES(?,?,?,?,?,?);
    </insert>

    <insert id="insertAction" sqlfile="insertData/action.json">
        INSERT INTO IDMF_ACTION(ACTION_ID, ACTION_CODE, RULE_ID, VALUE_TYPE, EVAL_TYPE, VALUE) VALUES(?,?,?,?,?,?);
    </insert>

    <insert id="insertCondition" sqlfile="insertData/condition.json">
        INSERT INTO IDMF_CONDITION(CONDITION_ID, CONDITION_CODE, RULE_ID, VALUE_TYPE, EVAL_TYPE, VALUE) VALUES(?,?,?,?,?,?);
    </insert>

    <insert id="insertRevision">
        INSERT INTO IDMF_REVISION(REVISION) VALUES(?);
    </insert>

    <update id="updateRevision">
        UPDATE IDMF_REVISION SET REVISION = ?
    </update>

    <select id="selectAllPolicy">
        SELECT * FROM IDMF_POLICY
    </select>

    <select id="selectAllRule">
        SELECT * FROM IDMF_RULE
    </select>

    <select id="selectAllSubject">
        SELECT * FROM IDMF_SUBJECT
    </select>

    <select id="selectAllResource">
        SELECT * FROM IDMF_RESOURCE
    </select>

    <select id="selectAllAction">
        SELECT * FROM IDMF_ACTION
    </select>

    <select id="selectAllCondition">
        SELECT * FROM IDMF_CONDITION
    </select>

    <select id="selectRevision">
        SELECT REVISION FROM IDMF_REVISION
    </select>

    <select id="checkRevisionTable">
        SELECT name FROM sqlite_master WHERE type='table' AND name='IDMF_REVISION';
    </select>
</sqlMap>

